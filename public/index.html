<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Portal</title>
<style>
body{margin:0;background:#0f172a;color:#e5e7eb;font-family:system-ui}
.container{max-width:600px;margin:auto;padding:1rem}
.post{background:#020617;padding:1rem;border-radius:8px;margin-bottom:1rem}
textarea{width:100%;padding:.6rem;border-radius:6px}
button{margin-top:.5rem;padding:.5rem 1rem;background:#2563eb;border:none;border-radius:6px;color:white}
</style>
</head>
<body>
<div class="container">
<h1>Portal Feed</h1>

<textarea id="content" placeholder="Say something..."></textarea>
<button onclick="post()">Post</button>

<div id="feed"></div>
</div>

<script>
async function post(){
  const token = localStorage.getItem('token')
  const content = document.getElementById('content').value

  const res = await fetch('/api/posts/create',{
    method:'POST',
    headers:{
      'Content-Type':'application/json',
      'Authorization':'Bearer '+token
    },
    body:JSON.stringify({content})
  })
  document.getElementById('content').value=''
  load()
}

async function load(){
  const res = await fetch('/api/posts/feed')
  const data = await res.json()
  const feed = document.getElementById('feed')
  feed.innerHTML=''
  data.posts.forEach(p=>{
    const div=document.createElement('div')
    div.className='post'
    div.innerHTML=`<b>@${p.users.username}</b><br>${p.content}`
    feed.appendChild(div)
  })
}
load()
</script>
</body>
</html>
