<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login â€” Grove</title>
<style>
  body {margin:0;padding:0;min-height:100vh;display:flex;justify-content:center;align-items:center;font-family:system-ui;background:#000;color:#a259ff;}
  .form-container {width:90%;max-width:400px;padding:2rem;border:1px solid #a259ff;border-radius:12px;box-shadow:0 0 20px #a259ff33;text-align:center;}
  .form-header {font-size:1.5rem;margin-bottom:1.5rem;color:#a259ff;text-shadow:0 0 10px #a259ff,0 0 20px #b280ff;}
  input {width:100%;padding:0.7rem;margin-bottom:1rem;border:1px solid #a259ff;border-radius:8px;background:#000;color:#fff;font-size:1rem;}
  input::placeholder {color:#a259ff88;}
  button {width:100%;padding:0.8rem;font-size:1rem;border:none;border-radius:8px;background:#a259ff;color:#000;font-weight:bold;cursor:pointer;box-shadow:0 0 10px #a259ff;transition:0.3s all;}
  button:hover {box-shadow:0 0 20px #b280ff;transform:translateY(-2px);}
  .message {margin-top:0.5rem;font-size:0.85rem;opacity:0.9;}
  .message.success {color:#2ecc71;}
  .message.error {color:#e74c3c;}
  .note {font-size:0.75rem;opacity:0.7;margin-top:0.5rem;text-align:left;}
</style>
</head>
<body>
  <div class="form-container">
    <div class="form-header">Login</div>
    <form id="login-form">
      <input type="email" id="email" placeholder="Email" required>
      <input type="password" id="password" placeholder="Password" required>
      <button type="submit">Login</button>
      <div id="message" class="message"></div>
    </form>
    <div class="note">Enter your credentials to access your profile.</div>
  </div>

<script>
const form = document.getElementById('login-form');
const messageEl = document.getElementById('message');

form.addEventListener('submit', async e => {
  e.preventDefault();
  const email = document.getElementById('email').value.trim();
  const password = document.getElementById('password').value;

  messageEl.textContent = '';
  messageEl.className = 'message';

  try {
    const res = await fetch('/api/login', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({email,password})
    });

    const text = await res.text();
    let data;
    try { data = JSON.parse(text); } catch { throw new Error(text); }
    if(!res.ok) throw new Error(data.error || 'Login failed');

    localStorage.setItem('token', data.session.access_token);
    window.location.href = '/pages/profile.html';
  } catch(err){
    messageEl.textContent = `Error: ${err.message}`;
    messageEl.classList.add('error');
  }
});
</script>
</body>
</html>
