<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Profile</title>
<style>
body {
  margin:0;
  font-family:system-ui, Arial, sans-serif;
  background:#0f172a;
  color:#e5e7eb;
  display:flex;
  align-items:center;
  justify-content:center;
  height:100vh;
}
.container {
  background:#020617;
  padding:24px;
  border-radius:10px;
  width:320px;
  text-align:center;
  display:flex;
  flex-direction:column;
  gap:12px;
}
button {
  padding:10px;
  border-radius:6px;
  border:none;
  cursor:pointer;
}
#logout { background:#2563eb; color:white; }
#delete { background:#dc2626; color:white; }
</style>
</head>
<body>
<div class="container">
  <h2>Profile</h2>
  <button id="logout">Logout</button>
  <button id="delete">Delete My Account</button>
  <p id="message"></p>
</div>

<script>
const token = localStorage.getItem('token');
if (!token) location.href = '/pages/login.html';

logout.onclick = () => {
  localStorage.removeItem('token');
  location.href = '/pages/login.html';
};

delete.onclick = async () => {
  const email = prompt('Enter email to delete:');
  if(!email) return;
  const msg = document.getElementById('message');
  msg.textContent = 'Deleting...';

  try {
    const res = await fetch('/api/delete-user', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ email })
    });

    const text = await res.text();
    try { 
      msg.textContent = JSON.parse(text).message; 
    } catch { 
      msg.textContent = text; 
    }

    localStorage.removeItem('token');
    setTimeout(()=>location.href='/pages/signup.html',1200);

  } catch(err) {
    msg.textContent = err.message;
  }
};
</script>
</body>
</html>
