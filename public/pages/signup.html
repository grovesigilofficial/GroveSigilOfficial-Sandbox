<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Signup</title>
</head>
<body>

  <h1>Signup</h1>

  <form id="signupForm">
    <input
      id="email"
      type="email"
      placeholder="Email"
      required
    />

    <input
      id="password"
      type="password"
      placeholder="Password"
      required
    />

    <button type="submit">Sign Up</button>
  </form>

  <script>
    document
      .getElementById('signupForm')
      .addEventListener('submit', async (e) => {
        e.preventDefault();

        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        const res = await fetch('/api/signup', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ email, password })
        });

        // IMPORTANT PART — fixes "Unexpected token" error
        const text = await res.text();

        let data;
        try {
          data = JSON.parse(text);
        } catch {
          throw new Error(text);
        }

        if (!res.ok) {
          throw new Error(data.error || 'Signup failed');
        }

        console.log('Signup success:', data);
        alert('Signup successful — check your email');
      });
  </script>

</body>
</html>
